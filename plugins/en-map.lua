{"changed":true,"filter":false,"title":"en-map.lua","tooltip":"/ASD_KARBALA/plugins/en-map.lua","value":"— Function reference: http://mathjs.org/docs/reference/functions/categorical.html\n\nlocal function mathjs(exp)\n  local url = 'http://api.mathjs.org/v1/'\n  url = url..'?expr='..URL.escape(exp)\n  local b,c = http.request(url)\n  local text = nil\n  if c == 200 then\n    text = '= '..b\n  \n  elseif c == 400 then\n    text = b\n  else\n    text = 'Error!'\n  end\n  return text\nend\n\nlocal function run(msg, matches)\n  return mathjs(matches[1])\nend\n\nreturn {\n  description = \"Calculate Your Formulas\",\n  usage = \"/احسب (formulas) : ex.formulas (3+7)*(2^3)/5\",\n  patterns = {\n    \"^[!/]احسب (.*)$\"\n  },\n  run = run\n}","undoManager":{"mark":-2,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":60,"column":3},"action":"remove","lines":["--[[ ","▀▄ ▄▀▀▄▄▀▀▄▄▀▀▄▄▀▀▄▄▀▀▄▄▀▀▄▄▀▀▄▀▄▄▀▀▄▄▀▀▄▄▀▀▄▄▀▀          ","▀▄ ▄▀                                      ▀▄ ▄▀ ","▀▄ ▄▀    BY SAJJAD NOORI                   ▀▄ ▄▀ ","▀▄ ▄▀     BY SAJAD NOORI (@SAJJADNOORI)    ▀▄ ▄▀ ","▀▄ ▄▀ JUST WRITED BY SAJJAD NOORI          ▀▄ ▄▀   ","▀▄ ▄▀         map  : طقس                   ▀▄ ▄▀ ","▀▄▀▀▄▄▀▀▄▄▀▄▄▀▀▄▄▀▀▄▄▀▄▄▀▀▄▄▀▀▄▄▀▄▄▀▀▄▄▀▀▄▄▀▄▄▀▀","--]]","do","","local api_key = nil","","local base_api = \"https://maps.googleapis.com/maps/api\"","","function get_staticmap(area)","  local api        = base_api .. \"/staticmap?\"","","  -- Get a sense of scale","  local lat,lng,acc,types = get_latlong(area)","","  local scale = types[1]","  if     scale==\"locality\" then zoom=8","  elseif scale==\"country\"  then zoom=4","  else zoom = 13 end","    ","  local parameters =","    \"size=600x300\" ..","    \"&zoom=\"  .. zoom ..","    \"&center=\" .. URL.escape(area) ..","    \"&markers=color:red\"..URL.escape(\"|\"..area)","","  if api_key ~=nil and api_key ~= \"\" then","    parameters = parameters .. \"&key=\"..api_key","  end","  return lat, lng, api..parameters","end","","","function run(msg, matches)","  local receiver\t= get_receiver(msg)","  local lat,lng,url\t= get_staticmap(matches[1])","","  -- Send the actual location, is a google maps link","  send_location(receiver, lat, lng, ok_cb, false)","","  -- Send a picture of the map, which takes scale into account","  send_photo_from_url(receiver, url)","","  -- Return a link to the google maps stuff is now not needed anymore","  return nil","end","","return {","  description = \"Get Man Location by Name\", ","  usage = \"map (name) : get map and location\",","  patterns = {\"^map (.*)$\"}, ","  run = run ","}","","end"],"id":2},{"start":{"row":0,"column":0},"end":{"row":29,"column":1},"action":"insert","lines":["— Function reference: http://mathjs.org/docs/reference/functions/categorical.html","","local function mathjs(exp)","  local url = 'http://api.mathjs.org/v1/'","  url = url..'?expr='..URL.escape(exp)","  local b,c = http.request(url)","  local text = nil","  if c == 200 then","    text = '= '..b","  ","  elseif c == 400 then","    text = b","  else","    text = 'Error!'","  end","  return text","end","","local function run(msg, matches)","  return mathjs(matches[1])","end","","return {","  description = \"Calculate Your Formulas\",","  usage = \"/احسب (formulas) : ex.formulas (3+7)*(2^3)/5\",","  patterns = {","    \"^[!/]احسب (.*)$\"","  },","  run = run","}"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":29,"column":1},"end":{"row":29,"column":1},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1462379199000}